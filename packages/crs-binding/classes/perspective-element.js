class i extends HTMLElement{#t;#s;#e;get hasOwnContext(){return!0}get ctx(){return this._dataId}set ctx(t){if(this._dataId=t,t!=null){const e=this.getAttribute("name");e!=null&&crs.binding.data.setName(this._dataId,e),this.#i().catch(s=>console.error(s))}}get view(){return this.#t}set view(t){this.#t!=t&&(this.#t=t,this.#i().catch(e=>console.error(e)))}constructor(){super();const t=this.getAttribute("ctx.one-way")||this.getAttribute("ctx.once");this.hasOwnContext==!0&&t==null&&(this._dataId=crs.binding.data.addObject(this.constructor.name),crs.binding.data.addContext(this._dataId,this)),crs.binding.dom.enableEvents(this)}dispose(){crs.binding.dom.disableEvents(this),crs.binding.templates.remove(this.#e).catch(t=>console.error(t))}async connectedCallback(){await this.#a(),this.dataset.ready="true",this.dispatchEvent(new CustomEvent("ready",{bubbles:!1}))}async#a(){this.#s=!0,this.#e=this.dataset.store||this.constructor.name,this.#t=await crs.binding.templates.createStoreFromElement(this.#e,this),await this.preLoad?.(),await this.load?.(),this.#s=!1,await this.#i()}async disconnectedCallback(){this.dispose(),crs.binding.utils.disposeProperties(this)}getProperty(t){return crs.binding.data.getProperty(this,t)}setProperty(t,e,s=!1){crs.binding.data.setProperty(this,t,e)}async#i(){if(this.#s==!0||this.#t==null||this._dataId==null)return;this.innerHTML="";const t=await crs.binding.templates.getStoreTemplate(this.#e,this.#t);this.appendChild(t),await crs.binding.parsers.parseElements(this.children,this._dataId,{folder:this.dataset.folder}),requestAnimationFrame(()=>{this.dataset.view=this.#t,this.dispatchEvent(new CustomEvent("view-loaded"))})}}customElements.define("perspective-element",i);export{i as PerspectiveElement};
