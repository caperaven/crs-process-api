async function d(s,e="context"){const t=[],i=[];return s.nodeName==="TEMPLATE"&&(s=s.content.cloneNode(!0).firstElementChild),s.nodeName!="#document-fragment"&&await $("element",s,i,t,e),s.children.length===0?await x("element",s,t,e):await p("element",s,i,t,e),new Function("element",e,[...i,...t].join(`
`))}async function x(s,e,t,i){const o=await crs.binding.expression.sanitize(e.textContent.trim(),i);t.push([s,".textContent = `",o.expression,"`;"].join(""))}async function p(s,e,t,i,o){for(let n=0;n<e.children.length;n++){const a=e.children[n];if(a.children.length>0)await p(`${s}.children[${n}]`,a,t,i,o);else{const c=await crs.binding.expression.sanitize(a.textContent.trim(),o);i.push([s,".children",`[${n}].textContent = `,"`",c.expression,"`;"].join(""))}await $(`${s}.children[${n}]`,e.children[n],t,i,o)}}async function $(s,e,t,i,o){if(!(e instanceof DocumentFragment))for(const n of e.attributes)if(n.nodeValue.indexOf("${")!=-1){t.push(`${s}.removeAttribute("${n.nodeName}");`);const a=await crs.binding.expression.sanitize(n.nodeValue.trim(),o);i.push([`${s}.setAttribute("${n.nodeName}",`,"`",a.expression,"`",");"].join(""))}else n.nodeName.indexOf("style.")!=-1?await y(n,s,t,i,o):n.nodeName.indexOf("classlist.case")!=-1?await h(n,s,t,i,o):n.nodeName.indexOf("classlist.if")!=-1?await m(n,s,t,i,o):n.nodeName.indexOf(".if")!=-1&&await w(n,s,t,i,o)}async function h(s,e,t,i,o){const a=(await crs.binding.expression.sanitize(s.nodeValue.trim(),o)).expression.split(","),c=[];for(const u of a){const l=u.split("?"),f=l[0].trim(),r=(l[1]||l[0]).split(":");c.push(...r),i.push(`if (${f}) {`),i.push(`    ${e}.classList.add(${r[0].trim()});`),i.push("}"),r.length>1&&(i.push("else {"),i.push(`    ${e}.classList.add(${r[0].trim()});`),i.push("}"))}t.push(`${e}.classList.remove(${c.join(",")});`)}async function m(s,e,t,i,o){const n=s.nodeValue.split("?")[1].split(":");t.push(`${e}.classList.remove(${n.join(",")});`);const a=await crs.binding.expression.sanitize(s.nodeValue.trim(),o);i.push([`${e}.classList.add(`,a.expression,");"].join(""))}async function w(s,e,t,i,o){t.push(`${e}.removeAttribute("${s.nodeName}");`);const n=await crs.binding.expression.sanitize(s.nodeValue.trim(),o);i.push([`${e}.setAttribute("${s.nodeName.replace(".if","")}",`,n.expression,");"].join(""))}async function y(s,e,t,i,o){const n=s.nodeName.split("."),a=await crs.binding.expression.sanitize(s.nodeValue.trim(),o);if(t.push(`${e}.style.${n[1]} = "";`),s.nodeName.indexOf(".case")==-1)i.push([`${e}.style.${n[1]} =`,a.expression,";"].join(""));else{const c=a.expression.split(",");for(const u of c){if(u.indexOf("context.default")!=-1){t.push(`${e}.style.${n[1]} = ${u.split(":")[1].trim()};`);continue}const l=u.split("?"),f=l[0].trim(),r=(l[1]||l[0]).split(":");i.push(`if (${f}) {`),i.push(`    ${e}.style.${n[1]} = ${r[0].trim()};`),i.push("}"),r.length>1&&(i.push("else {"),i.push(`    ${e}.style.${n[1]} = ${r[1].trim()};`),i.push("}"))}}}crs.binding.expression.inflationFactory=d;export{d as inflationFactory};
